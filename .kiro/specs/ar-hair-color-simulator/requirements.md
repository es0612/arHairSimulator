# 要件定義書

## 概要

ARヘアカラーシミュレーターは、AR技術を活用してユーザーがリアルタイムで仮想的に髪の色を変更できるiOSモバイルアプリケーションです。このアプリは、美容サロンを訪れる前や永続的な変更を行う前に、リスクなしで異なる色を試すことで、ヘアカラー選択に対する不安を軽減することを目的としています。高精度のARシミュレーションにより、落ち着いた、ストレスフリーな美容体験の提供に焦点を当て、ヘアカラー変更を検討している20-40代のユーザーをターゲットとしています。

## 要件

### 要件1: ユーザー登録とプロフィール管理

**ユーザーストーリー:** ユーザーとして、アカウントを作成してプロフィールを設定したい。そうすることで、設定やシミュレーション履歴を保存できるから。

#### 受け入れ基準

1. ユーザーが初回アプリを開いた時、システムはApple ID、Google、メールアドレスでの登録オプションを提示する
2. ユーザーが登録を完了した時、システムは年齢、性別、髪質（ストレート/カール/ウェーブ）を含む基本プロフィール情報の入力を促す
3. ユーザーがプロフィールを設定した時、システムはこの情報をローカルに保存し、オプションでFirebaseに同期する
4. ユーザーが追加設定の保存を選択した場合、システムはパーソナライゼーションのための肌色と顔型の入力を許可する
5. ユーザーがアカウント登録をスキップした場合、システムは基本機能をゲストモードで提供し、後でアカウント作成を促す

### 要件2: リアルタイムARヘアカラーシミュレーション

**ユーザーストーリー:** ユーザーとして、カメラを使ってリアルタイムで髪の色が変わるのを見たい。そうすることで、異なる色が自分にどう見えるかを視覚化できるから。

#### 受け入れ基準

1. ユーザーがARカメラビューを起動した時、システムはフロントカメラを使用してリアルタイムでユーザーの顔を追跡する
2. カメラが顔を検出した時、システムはARKitとVisionフレームワークを使用して髪の領域を自動的にセグメント化する
3. 髪のセグメント化がアクティブな時、システムは選択された色を30fps以上で髪の領域に適用する
4. 照明条件が変化した時、システムは深度情報を使用して自然な色のブレンドを維持する
5. システムが髪を明確に検出できない場合、システムはユーザーの位置調整をガイドする視覚的フィードバックを提供する

### 要件3: 色選択とカスタマイズ

**ユーザーストーリー:** ユーザーとして、豊富な種類のヘアカラーから選択し、好みに合わせて調整したい。そうすることで、完璧な色合いを見つけることができるから。

#### 受け入れ基準

1. ユーザーがカラーパレットにアクセスした時、システムはカテゴリ別に整理された少なくとも100種類の異なるヘアカラーを表示する
2. ユーザーが色を選択した時、システムはセグメント化された髪の領域に即座に適用する
3. ユーザーが色を微調整したい時、システムは明度と彩度調整のためのスライダーを提供する
4. ユーザーがグラデーションやハイライト効果を選択した時、システムはこれらの高度なスタイリングオプションをヘアシミュレーションに適用する
5. ユーザーが色を比較したい場合、システムは異なる色オプション間の素早い切り替えを許可する

### 要件4: ビフォー・アフター比較

**ユーザーストーリー:** ユーザーとして、元の髪色とシミュレーションされた色を比較したい。そうすることで、十分な情報に基づいた決定を下すことができるから。

#### 受け入れ基準

1. ユーザーがヘアカラーシミュレーションを表示している時、システムは元の外観とシミュレーションされた外観を切り替えるスワイプジェスチャーを提供する
2. 色を比較する時、システムは正確な比較のために同じ照明と角度を維持する
3. ユーザーがビュー間を切り替える時、遷移はスムーズで瞬時である

### 要件5: 保存と共有機能

**ユーザーストーリー:** ユーザーとして、お気に入りのシミュレーションを保存し、他の人と共有したい。そうすることで、フィードバックを得て、好みのルックを覚えておくことができるから。

#### 受け入れ基準

1. ユーザーがシミュレーション結果を気に入った時、システムは写真と短い動画の両方でデバイスストレージに保存することを許可する
2. ユーザーが共有したい時、システムはオプションのウォーターマーク付きでInstagramとTwitterへの直接共有を提供する
3. ユーザーがシミュレーションを保存した時、システムは保存されたすべてのルックの履歴リストを維持する
4. ユーザーが履歴にアクセスした時、システムは以前に保存された色の組み合わせの再適用を許可する
5. ユーザーが保存を整理したい場合、システムは保存されたルックの基本的な分類を許可する

### 要件6: ユーザーオンボーディングとガイダンス

**ユーザーストーリー:** 新規ユーザーとして、AR機能の使用方法について明確なガイダンスが欲しい。そうすることで、アプリから最良の結果を得ることができるから。

#### 受け入れ基準

1. ユーザーが初回アプリを開いた時、システムはARの位置決めと機能を示すインタラクティブなチュートリアルを表示する
2. チュートリアルがアクティブな時、システムは最適なカメラの位置決めと照明のための視覚的ガイドを提供する
3. ユーザーが髪の検出に苦労している時、システムは役立つヒントと位置決めガイダンスを提供する
4. ユーザーがチュートリアルをスキップした場合、システムはアプリ内でヘルプ情報へのアクセスを提供する

### 要件7: オフライン機能

**ユーザーストーリー:** ユーザーとして、インターネット接続なしで基本的なAR機能を使用したい。そうすることで、どこでもヘアカラーを試すことができるから。

#### 受け入れ基準

1. アプリがインターネット接続なしで使用される時、システムはローカル処理を使用して完全なARシミュレーション機能を提供する
2. オフライン時、システムはローカルに保存されたすべての基本カラーパレットにアクセスする
3. 接続が復元された時、システムは保存されたシミュレーションをユーザーのクラウドストレージに同期する
4. 高度な機能がインターネットを必要とする場合、システムはどの機能が接続を必要とするかを明確に示す

### 要件8: プライバシーとデータ保護

**ユーザーストーリー:** プライバシーを重視するユーザーとして、カメラデータと個人情報を保護してほしい。そうすることで、安心してアプリを使用できるから。

#### 受け入れ基準

1. アプリがカメラデータを処理する時、システムはすべての顔追跡と髪のセグメント化をデバイス上でローカルに実行する
2. ユーザーデータが収集される時、システムはGDPR要件に準拠し、明確なプライバシーポリシーを提供する
3. 顔データが処理される時、システムは一時的に保存される可能性のあるデータを匿名化する
4. ユーザーがアカウントの削除を選択した場合、システムはローカルおよびクラウドストレージから関連するすべてのデータを削除する

### 要件9: パフォーマンスと互換性

**ユーザーストーリー:** iOSユーザーとして、デバイス上でアプリがスムーズに動作してほしい。そうすることで、シームレスなAR体験を得ることができるから。

#### 受け入れ基準

1. アプリが起動する時、システムはサポートされているデバイスで1秒以内に開始する
2. AR処理がアクティブな時、システムは少なくとも30fpsのパフォーマンスを維持する
3. iOS 15以降で動作する時、システムは完全な機能を提供する
4. LiDARを搭載していないデバイスで動作する場合、システムは基本的な顔追跡に適切にフォールバックする
5. メモリ使用量が高い時、システムはクラッシュすることなくパフォーマンスを最適化する

### 要件10: 落ち着いたアクセシブルなデザイン

**ユーザーストーリー:** ストレスフリーな美容体験を求めるユーザーとして、落ち着いていて使いやすいインターフェースが欲しい。そうすることで、異なるルックを試すことに集中できるから。

#### 受け入れ基準

1. ユーザーインターフェースが表示される時、システムはソフトなパステルカラーと十分な余白を持つミニマリストデザインを使用する
2. アニメーションが使用される時、システムは落ち着いた雰囲気を維持するために、それらを控えめでスムーズに保つ
3. アプリが使用される時、システムはライトモードとダークモードの両方をサポートする
4. アクセシビリティ機能が必要な時、システムはVoiceOverサポートと高コントラストオプションを提供する
5. 通知が送信される場合、システムは穏やかなテクノロジーの原則に従って中断を最小限に抑える